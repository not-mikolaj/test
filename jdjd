@echo off
:: Elevate to administrator if not already
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo Requesting administrative privileges...
    powershell -Command "Start-Process '%~f0' -Verb RunAs"
    exit /b
)

echo.
echo === Starting installations from 'installers' folder ===
echo.

:: Set the path to the 'installers' subfolder
set "INSTALLER_DIR=%~dp0installers"

:: Run each EXE installer from the 'installers' folder
start /wait "" "%INSTALLER_DIR%\Installer1.exe"
echo Installer1.exe completed.

start /wait "" "%INSTALLER_DIR%\Installer2.exe"
echo Installer2.exe completed.

start /wait "" "%INSTALLER_DIR%\Installer3.exe"
echo Installer3.exe completed.

start /wait "" "%INSTALLER_DIR%\Installer4.exe"
echo Installer4.exe completed.

:: Run the additional batch script
start /wait "" "%INSTALLER_DIR%\YourScript.bat"
echo YourScript.bat completed.

:: Run ReportIP tasks
start /wait "" "%~dp0ReportIP.bat"
echo ReportIP.bat completed.

echo.
echo === All tasks completed successfully ===
pause
